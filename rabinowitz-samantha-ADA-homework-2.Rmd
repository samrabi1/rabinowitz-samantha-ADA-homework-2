---
title: "ADA Homework 2"
author: "Samantha Rabinowitz, sar4357"
date: "3/3/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Challenge 1

The R code below will load the 'movies.csv' dataset from GitHub and organize the data into a tibble.

```{r}
library(tidyverse)

f <- "https://raw.githubusercontent.com/difiore/ADA-datasets/master/IMDB-movies.csv"
d <- read_csv(f, col_names = T)
glimpse(d)
```

The following code will filter the dataset to just include movies from 1920 to 1979 and movies that are less than 4 hours long. Columns were also added to make **startYear** a new variable called **decade**.

```{r}
d1 <- d %>%
  filter(startYear >= "1920" & startYear <="1979" & runtimeMinutes < 240) %>%
  mutate(decade = case_when(startYear >=1920 & startYear<=1929 ~ "20s",
                            startYear >=1930 & startYear<=1939 ~ "30s",
                            startYear >=1940 & startYear<=1949 ~ "40s",
                            startYear >=1950 & startYear<=1959 ~ "50s",
                            startYear >=1960 & startYear<=1969 ~ "60s",
                            startYear >=1970 & startYear<=1979 ~ "70s"))
d1 %>% glimpse()
```

The code below utilizes *ggplot* to plot histograms of the distribution of **runtimeMinutes** for each decade. 

```{r}
d1 %>%
  ggplot(aes(x=runtimeMinutes)) + geom_histogram(bins=60) + facet_wrap(~ decade)
```

The R code below will compute the population mean and population standard deviation in **runtimeMinutes** for each decade and store the values in a new dataframe, *results*.

```{r}
library(radiant)
results <- d1 %>% group_by(decade) %>% summarize(mean=mean(runtimeMinutes),
                                      pop_sd=sdpop(runtimeMinutes))
results %>% glimpse()
```

The following code will generate a function to calculate the standard error of the mean for each decade as well as a single sample of 100 movies from each decade and calculate the sample mean and standard deviation for each decade. Additionally, the SE around each population mean for each decade will be estimated using the standard deviation and sample size of these samples.

```{r}
std_error <- function(x) {
  sd(x) / sqrt(length(x))
}
d1 %>% group_by(decade) %>% sample_n(100, replace=FALSE) %>% 
  summarize(mean(runtimeMinutes), sd(runtimeMinutes),std_error(runtimeMinutes))
```

The code below will write a function to calculate the standard error of the mean for each deacde using the population standard deviation for purposes of comparison to the values obtained from the sample created above.

```{r}
pop_std_error <- function(x) {
  sdpop(x) / sqrt(length(x))
}
d1 %>% group_by(decade) %>%
  summarize(mean = mean(runtimeMinutes),
            sdpop = sdpop(runtimeMinutes),
            pop_se = pop_std_error(runtimeMinutes),
            length(decade))
```

## Challenge 3

The R code below will load the 'zombies.csv' dataset from GitHub and organize the data into a tibble.

```{r}
f <- "https://raw.githubusercontent.com/difiore/ADA-datasets/master/zombies.csv"
d <- read_csv(f, col_names = T)
glimpse(d)
```

The code below will calculate the population mean and standard deviation for each quantitative random variable.

```{r}
d %>% summarize(height_mean=mean(height),
                height_sd=sdpop(height),
                weight_mean=mean(weight),
                weight_sd=sdpop(weight),
                age_mean=mean(age),
                age_sd=sdpop(age),
                n_zombies_mean=mean(zombies_killed),
                n_zombies_sd=sdpop(zombies_killed),
                ed_mean=mean(years_of_education),
                ed_sd=sdpop(years_of_education))
```

The following will utilize *ggplot2* to make scatterplots of height and weight in relation to age. 

```{r}
d %>% ggplot(aes(x=age,y=height)) + geom_point()
d %>% ggplot(aes(x=age,y=weight)) + geom_point()
```

The scatterplot generated for height in relation to age shows a distinct positive relationship. The scatterplot generated for weight in relation to age does not show as strong of a relationship however there is still a positive tendency to the relationship between the two variables.